<html>
    <head>
        <title>Entity Framework</title>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>

    <body>

        <div id="header">
            <h1>Entity Framework</h1>
        </div>

        <div id="article">
        Requires <i>EntityFramework.dll</i>.</br></br>

        When creating an Entity Framework model, several options are available:</br>
        <ul>
            <li><b>Code First:</b> Define the model using code, then generate the database from this.</li>
            <li><b>Code First to Existing Database:</b> Use code to create the model that maps to an existing database.</li>
            <li><b>Model First:</b> Define the model in a graphical editor and generate a database from this.</li>
            <li><b>Database First:</b> Create a model in the graphical editor that maps to an existing database.</li>
        </ul>        
        </div>

        <div id="article">
            <h2>Architecture</h2>
            <img src="images/ef-model-code-map.png">
        </div>

        <div id="article">
            <h2>DbModelBuilder</h2>
            Exists within the <i>System.Data.Entity</i> namespace, <i>DbModelBuilder</i> maps classes to a database schema. It could be used for the 'code first' method, or generated by building a 'database first' Entity Framework model. Here the model can be configured by overriding the DbContext.</br></br>

            The <i>DbModelBuilder</i> class contains:</br>
            <ul>
                <li>public DbModelBuilder()</li>
                <li>public DbModelBuilder(DbModelBuilderVersion modelBuilderVersion)</li>
                <li>public virtual ConfigurationRegistrar Configurations { get; }</li>
                <li>public virtual DbModel Build(DbConnection providerConnection)</li>
                <li>public virtual DbModel Build(DbProviderInfo providerInfo)</li>
                <li>public virtual ComplexTypeConfiguration<TComplexType> ComplexType<TComplexType>() where TComplexType : class;</li>
                <li>public virtual EntityTypeConfiguration<TEntityType> Entity<TEntityType>() where TEntityType : class;
                </li>public override bool Equals(object obj)</li>
                <li>public override int GetHashCode()</li>
                <li>public Type GetType()</li>
                <li>public virtual DbModelBuilder HasDefaultSchema(string schema)</li>
            </ul>          
        </div>

        <div id="article">
            <h2>Sending Data to Stored Procedures</h2>
            The following code is found in <i>[DatabaseName].Context.cs</i>:</br>

            <code>
                public virtual ObjectResult<prStoredProcedure_Result> prStoredProcedure(Nullable<int> noOfDays)</br>
                {</br>
                    var noOfDaysParameter = noOfDays.HasValue ?</br>
                    new ObjectParameter("NoOfDays", noOfDays) :</br>
                    new ObjectParameter("NoOfDays", typeof(int));</br></br>
    
                    return ((IObjectContextAdapter)this).ObjectContext.ExecuteFunction<prStoredProcedure_Result>("prStoredProcedure", noOfDaysParameter);</br>
                }</br>
            </code>
        </div>


        <div id="article">
            <h2>Return Data</h2>
            <code>
                public partial class prStoredProcedure_Result</br>
                {</br>
                    public Nullable<System.Guid> Id { get; set; }</br>
                    public string HealthBoard { get; set; }</br>
                    public string HealthBoardDescription { get; set; }</br>
                    public Nullable<int> MessagesProcessed { get; set; }</br>
                }</br>
            </code>
        </div>

        <div id="article">
            <h2>References</h2>
            ENTITYFRAMEWORKTUTORIAL.NET. 2016. <i>Entity Framework Tutorial</i>. [WWW]. <a href="http://www.entityframeworktutorial.net">www.entityframeworktutorial.net</a>. 21st April 2017.</br></br>
        </div>

        <div id="footer">Michael, April 2017</div>
    </body>
</html>
