<html>
    <head>
        <title>Node.js and Express.js</title>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>

    <body>

        <h1>Node.js and Express.js</h1>

        <div id="article">
			The main purpose of Node.js is to enable the creation of Web servers and associated network tools using JavaScript, and there are additional modules for performing server-side operations.  Node.js enables communication between the client-side JavaScript and the server.</br></br>

			A Node.js application has the following:</br>
			<ul>
				<li>Module imports</li>
				<li>Server creation</li>
				<li>Response</li>
			</ul>
	
		</div>
		
		<div id="article">
			<h2>File Operations</h2>
			Perhaps the main reason we want server-side code, rather than something entirely client-based is data persistence - storing and retrieving data on a server is a core feature of a Web application.</br></br>

			Here I have two files: <i>file-op.js</i> server-side script, and the <i>serverdata.txt</i> data file. The latter simply contains two lines of text. We import both the <i>http</i> and filesystem (<i>fs</i>) modules:</br>
			<code>var http = require("http");</code>
			<code>var fs = require("fs");</code></br></br>

			And specify the file to read:</br>
			<code>var data = fs.readFileSync('serverdata.txt');</code></br></br>

			And this time, the HTTP response is defined as the contents of <i>serverdata.txt</i>:</br>
			<code>
				http.createServer(function (request, response) </br>
				{</br>
					response.writeHead(200, {'Content-Type': 'text/plain'});</br>
					response.end(data.toString());</br>
				}).listen(8090);
			</code></br></br>

			The filesystem module enables the JavaScript to perform I/O with files using <i>createReadStream()</i> and <i>createWriteStream()</i>. As before, we import <i>http</i> and the filesystem modules, but declare the data as null. Another variable is needed to declare the read stream. Although this isn't too useful on its own, it demonstrates that Node.js can be used for persistent storage.</br></br>
		</div>

		<div id="article">
			<h2>Node.js Express</h2>
			This can be used to achieve the same thing as ASP.NET MVC, as it handles routing, REST requests and other server-side operations.

			First we need to use npm to install Express.js.
			<code>npm install express --save</code></br></br>

			To initiate an action, we only need to send its name as part of the URI in the browser. For example, 'http://localhost:8090/listusers' will cause express to return the response for that <i>app.get()</i> method.</br></br>
			As you've probably noticed, this looks much like the ASP.NET MVC controllers. The <i>res.sendFile()</i> line is equivalent to the <i>Return(View)</i> in an MVC controller, redirecting the browser to a view after an action was completed.
		</div>

		<div id="article">
			<h2>JSON</h2>
			Of course, most Web applications function as an interface to some data source. Here I'll try and use a JSON-based source to store and retrieve the data, with data being sent between the HTML and the JavaScript controllers.

			For the following the body-parser is required through npm:
			<code>npm install body-parser --save</code></br></br>

			In the HTML file we have a simple form with two fields. To the JavaScript file we add another method for handling the data submitted from the HTML.</br>

			Submitting data in the running Web site at this point will result in the data being JSON-formatted:</br>
			<code>{"firstName":"michael","secondName":"mysecondname","user_name":"michael","user_email":"michael@mail.com"}</code>

			Now we need a <i>.json</i> file for the application to append. Mine is called '<i>users.json</i>'.
		</div>
       
        <div id="article">
            <h2>References</h2>
			<a href="https://expressjs.com/en/guide/database-integration.html">Express.js Database Integration</a></br>
            <a href="https://nodejs.org/en/">Node.js Home...</a></br>
            <a href="https://expressjs.com">Express.js Home</a></br>
            <a href="https://www.tutorialspoint.com/nodejs/nodejs_introduction.htm">TutorialsPoint Node.js Introduction</a>
        </div>

        <div id="footer">Michael, April 2017</div>
    </body>
</html>
